<%- include('partials/header', { title: 'Reservas - Zap', activePage: 'reservas' }) %>

<section id="reservations" class="m-4">
    <div class="row justify-content-center">
        <div class="col-6 col-lg-6 bg-zapgrey p-4 border border-dark">
            <h2>Reservas</h2>
            <fieldset class="mx-auto">
                <legend>Formulario de las reservas</legend>
                <div class="progress rounded-0 mb-2 bg-zapgrey">
                    <div id="progressBar" class="progress-bar progress-bar-striped rounded-0" role="progressbar"
                        style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    </div>
                </div>
                <form id="reservationForm" method="POST" action="/reservar" aria-label="Formulario de la reserva" class="d-flex flex-column gap-3">
                    <div class="d-flex gap-2">
                        <div class="d-flex flex-column w-50">
                            <label for="fullName">Nombre y Apellidos: </label>
                            <input type="text" id="fullName" name="fullName" required class="form-text border-1 border-dark rounded-0 p-2">
                            <span id="fullNameError" class="error text-danger" aria-live="polite"></span>
                        </div>
                        <div class="d-flex flex-column w-50">
                            <label for="email">Correo electrónico: </label>
                            <input type="email" id="email" name="email" required class="form-text border-1 border-dark rounded-0 p-2">
                            <span id="emailError" class="error text-danger" aria-live="polite"></span>
                        </div>
                    </div>
                    <div>
                        <label for="selectedVehicle">Vehículo: </label>
                        <select id="selectedVehicle" name="vehicleId" required
                            class="form-select border-dark border-1 rounded-0">
                            <option value="" disabled selected hidden>Elige un vehículo</option>
                            <% for (let v of vehicles) { %>
                                <option value="<%= v.id_vehiculo %>">
                                    <%= v.marca %> <%= v.modelo %> - <%= v.color %> (<%= v.matricula %>)
                                </option>
                            <% } %>
                        </select>
                    </div>
                    <div class="d-flex gap-2">
                        <div class="d-flex flex-column w-50">
                            <label for="startTime">Fecha de inicio: </label>
                            <input type="datetime-local" id="startTime" name="startTime" class="form-control border border-1 p-2 rounded-0" required>
                            <span id="startTimeError" class="error text-danger" aria-live="polite"></span>
                        </div>
                        <div class="d-flex flex-column w-50">
                            <label for="endTime">Fecha fin: </label>
                            <input type="datetime-local" id="endTime" name="endTime" class="form-control border border-1 p-2 rounded-0" required>
                            <span id="endTimeError" class="error text-danger" aria-live="polite"></span>

                        </div>
                    </div>
                    <div>
                        <input id="checkboxInput" type="checkbox" name="conditions" required>
                        <span>Acepta las condiciones</span>
                    </div>
                    <div>
                        <button id="submitBtn" type="submit" aria-label="Enviar"
                            class="btn btn-dark rounded-0 px-4"><i class="bi bi-send-fill me-2"></i>Enviar</button>
                        <button id="resetBtn" type="reset" aria-label="Borrar" class="btn btn-danger rounded-0 px-4">
                            <i class="bi bi-trash-fill me-1"></i> Borrar formulario
                        </button>
                    </div>
                </form>
            </fieldset>
        </div>
        <div class="col-6">
            <% if (listareservas.length === 0) { %>
                <div class="w-full border border-dark p-2 bg-zapgrey">
                    <p class="text-center text-muted">No hay reservas aún.</p>
                </div>
            <% } else { %>
                <table id="reservation-container" class="table bg-white">
                    <thead>
                        <tr class="bg-zapgrey">
                            <th>Id</th>
                            <th>Nombre</th>
                            <th>Email</th>
                            <th>Vehículo</th>
                            <th>Fecha Inicio</th>
                            <th>Fecha Final</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% for(let reserva of listareservas) { %>
                            <tr data-reservation-id="<%= reserva.id_reserva %>">
                                <td><%= reserva.nombre %></td>
                                <td><%= reserva.correo %></td>
                                <td><%= reserva.id_vehiculo %></td>
                                <td><%= reserva.fecha_inicio %></td>
                                <td><%= reserva.fecha_fin %>
                                </td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            <% } %>
        </div>
    </div>
</section>

<script src="js/reservationForm.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>

<%- include('partials/footer') %>
